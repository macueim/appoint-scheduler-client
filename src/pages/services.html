<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Management - AppointScheduler</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body class="flex flex-col min-h-screen bg-gray-100 font-sans antialiased">

<!-- Header from index.html -->
<header class="bg-white shadow-lg py-4">
    <div class="container mx-auto px-4 flex flex-col md:flex-row justify-between items-center">
        <div class="flex items-center mb-4 md:mb-0">
            <img src="../../public/images/logo.png" alt="AppointScheduler Logo" class="mr-2 rounded-full shadow-sm" style="height:50px; width:50px;">
            <span class="text-2xl font-extrabold text-gray-900">AppointScheduler</span>
        </div>

        <div class="w-full md:w-1/3 mb-4 md:mb-0 relative">
            <input type="text" placeholder="Search for services or providers..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-300">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
                </svg>
            </div>
        </div>

        <nav class="hidden md:flex space-x-2">
            <a href="index.html" class="text-gray-700 font-medium py-2 px-4 rounded-lg hover:bg-blue-50 hover:text-blue-700 hover:shadow-md transform hover:scale-105 transition duration-300 ease-in-out">Home</a>
            <a href="#" class="text-gray-700 font-medium py-2 px-4 rounded-lg hover:bg-blue-50 hover:text-blue-700 hover:shadow-md transform hover:scale-105 transition duration-300 ease-in-out">About Us</a>
            <a href="#" class="text-gray-700 font-medium py-2 px-4 rounded-lg hover:bg-blue-50 hover:text-blue-700 hover:shadow-md transform hover:scale-105 transition duration-300 ease-in-out">Services</a>
            <a href="#" class="text-gray-700 font-medium py-2 px-4 rounded-lg hover:bg-blue-50 hover:text-blue-700 hover:shadow-md transform hover:scale-105 transition duration-300 ease-in-out">Your Cert.</a>
            <a href="#" class="text-blue-600 font-semibold py-2 px-4 rounded-lg hover:bg-blue-50 hover:text-blue-700 hover:shadow-md transform hover:scale-105 transition duration-300 ease-in-out">Login/Sign Up</a>
        </nav>

        <div class="md:hidden" x-data="{ open: false }">
            <button @click="open = !open" class="text-gray-600 hover:text-blue-600 focus:outline-none">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>

            <div x-show="open" @click.away="open = false" class="absolute top-44 right-4 bg-white shadow-lg rounded-md p-4 space-y-2 z-10 w-48 border border-gray-200">
                <a href="index.html" class="block text-gray-700 font-medium py-2 px-3 rounded-md hover:bg-blue-50 hover:text-blue-600 hover:shadow-sm transition duration-300">Home</a>
                <a href="#" class="block text-gray-700 font-medium py-2 px-3 rounded-md hover:bg-blue-50 hover:text-blue-600 hover:shadow-sm transition duration-300">About Us</a>
                <a href="#" class="block text-gray-700 font-medium py-2 px-3 rounded-md hover:bg-blue-50 hover:text-blue-600 hover:shadow-sm transition duration-300">Services</a>
                <a href="#" class="block text-gray-700 font-medium py-2 px-3 rounded-md hover:bg-blue-50 hover:text-blue-600 hover:shadow-sm transition duration-300">Your Cert.</a>
                <a href="#" class="block text-blue-600 font-semibold py-2 px-3 rounded-md hover:bg-blue-50 hover:text-blue-700 hover:shadow-sm transition duration-300">Login/Sign Up</a>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<main class="flex-grow container mx-auto px-4 py-8" x-data="serviceManager()">
    <!-- Business Info Section -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <div class="flex flex-col md:flex-row md:justify-between md:items-center">
            <div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">
                    <span x-text="businessData.name">Loading business name...</span>
                </h1>
                <p class="text-gray-600 mb-2">
                    <span class="font-semibold">Business ID:</span> <span x-text="businessData.id">Loading...</span>
                </p>
                <p class="text-gray-600 mb-2">
                    <span class="font-semibold">Joined:</span> <span x-text="formatDate(businessData.created_at)">Loading...</span>
                </p>
            </div>
            <div class="mt-4 md:mt-0">
                <button @click="showAddServiceModal = true" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    <i class="fas fa-plus mr-2"></i> Add New Service
                </button>
            </div>
        </div>
        <p class="text-gray-700 mt-4" x-text="businessData.description">Loading business description...</p>
    </div>

    <!-- Services Management Section -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center">
            <h2 class="text-xl font-bold text-gray-800 mb-4 sm:mb-0">Service Management</h2>

            <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 w-full sm:w-auto">
                <!-- Category Filter -->
                <select x-model="selectedCategory" @change="filterServices()" class="form-select rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                    <option value="all">All Categories</option>
                    <template x-for="category in categories" :key="category.id">
                        <option :value="category.id" x-text="category.name"></option>
                    </template>
                </select>

                <!-- Search Input -->
                <div class="relative">
                    <input type="text" x-model="searchQuery" @input="filterServices()" placeholder="Search services..." class="pl-10 pr-4 py-2 w-full sm:w-64 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-300">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div x-show="loading" class="flex justify-center items-center py-12">
            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
        </div>

        <!-- Error State -->
        <div x-show="error && !loading" class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded mb-6">
            <p class="font-bold">Error</p>
            <p x-text="errorMessage">Something went wrong. Please try again later.</p>
        </div>

        <!-- No Services State -->
        <div x-show="!loading && !error && filteredServices.length === 0" class="text-center py-12">
            <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
            <h3 class="mt-4 text-lg font-medium text-gray-900">No services found</h3>
            <p class="mt-1 text-gray-500" x-show="selectedCategory === 'all' && !searchQuery">You haven't added any services yet.</p>
            <p class="mt-1 text-gray-500" x-show="selectedCategory !== 'all' || searchQuery">No services match your current filters.</p>
            <div class="mt-6">
                <button @click="resetFilters()" x-show="selectedCategory !== 'all' || searchQuery" class="text-sm font-medium text-blue-600 hover:text-blue-500 mr-4">
                    Reset Filters
                </button>
                <button @click="showAddServiceModal = true" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Add New Service
                </button>
            </div>
        </div>

        <!-- Service Cards -->
        <div x-show="!loading && !error && filteredServices.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <template x-for="service in filteredServices" :key="service.id">
                <div class="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300">
                    <div class="p-5">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900" x-text="service.name"></h3>
                                <p class="text-sm text-blue-600 mb-2" x-text="getCategoryName(service.category_id)"></p>
                            </div>
                            <div class="flex space-x-2">
                                <button @click="editService(service)" class="text-gray-500 hover:text-blue-500 focus:outline-none">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button @click="confirmDeleteService(service.id)" class="text-gray-500 hover:text-red-500 focus:outline-none">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>

                        <p class="text-gray-600 text-sm mb-3" x-text="service.description"></p>

                        <div class="flex justify-between items-center pt-3 border-t border-gray-100">
                            <div class="text-gray-800 font-medium">
                                <span x-text="formatPrice(service.price)"></span>
                            </div>
                            <div class="text-sm text-gray-500">
                                <span x-text="service.duration"></span> minutes
                            </div>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Add/Edit Service Modal -->
    <div x-show="showAddServiceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" style="display: none;">
        <div @click.away="showAddServiceModal = false" class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-auto overflow-hidden" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform scale-90" x-transition:enter-end="opacity-100 transform scale-100">
            <div class="px-6 py-4 bg-blue-600 text-white flex justify-between items-center">
                <h3 class="text-lg font-medium" x-text="editingService ? 'Edit Service' : 'Add New Service'"></h3>
                <button @click="showAddServiceModal = false" class="text-white hover:text-gray-200 focus:outline-none">
                    <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <form @submit.prevent="saveService()" class="p-6 space-y-4">
                <!-- Name Field -->
                <div>
                    <label for="service-name" class="block text-sm font-medium text-gray-700 mb-1">Service Name</label>
                    <input type="text" id="service-name" x-model="serviceForm.name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                </div>

                <!-- Category Field -->
                <div>
                    <label for="service-category" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                    <select id="service-category" x-model="serviceForm.category_id" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="" disabled>Select a category</option>
                        <template x-for="category in categories" :key="category.id">
                            <option :value="category.id" x-text="category.name"></option>
                        </template>
                    </select>
                </div>

                <!-- Description Field -->
                <div>
                    <label for="service-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="service-description" x-model="serviceForm.description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <!-- Price and Duration Fields -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="service-price" class="block text-sm font-medium text-gray-700 mb-1">Price ($)</label>
                        <input type="number" id="service-price" x-model="serviceForm.price" min="0" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                    <div>
                        <label for="service-duration" class="block text-sm font-medium text-gray-700 mb-1">Duration (minutes)</label>
                        <input type="number" id="service-duration" x-model="serviceForm.duration" min="5" step="5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                    </div>
                </div>

                <!-- Form Buttons -->
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" @click="showAddServiceModal = false" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                        Cancel
                    </button>
                    <button type="submit" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        <span x-text="editingService ? 'Update' : 'Add'"></span> Service
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div x-show="showDeleteModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" style="display: none;">
        <div @click.away="showDeleteModal = false" class="bg-white rounded-lg shadow-xl max-w-md w-full mx-auto overflow-hidden" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform scale-90" x-transition:enter-end="opacity-100 transform scale-100">
            <div class="px-6 py-4 bg-red-600 text-white">
                <h3 class="text-lg font-medium">Confirm Deletion</h3>
            </div>

            <div class="p-6">
                <p class="text-gray-700 mb-6">Are you sure you want to delete this service? This action cannot be undone.</p>

                <div class="flex justify-end space-x-3">
                    <button @click="showDeleteModal = false" class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                        Cancel
                    </button>
                    <button @click="deleteService()" class="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Footer from index.html -->
<footer class="bg-white shadow-inner-top py-8">
    <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-between">
            <div class="w-full md:w-1/4 mb-6 md:mb-0">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">AppointScheduler</h3>
                <p class="text-gray-600 mb-4">The easiest way to schedule and manage your appointments online.</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-500 hover:text-blue-600 transition-colors duration-300">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="text-gray-500 hover:text-blue-400 transition-colors duration-300">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-500 hover:text-pink-600 transition-colors duration-300">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="text-gray-500 hover:text-blue-700 transition-colors duration-300">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                </div>
            </div>

            <div class="w-full md:w-1/4 mb-6 md:mb-0">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Links</h3>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Home</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">About Us</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Services</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Pricing</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Contact</a></li>
                </ul>
            </div>

            <div class="w-full md:w-1/4 mb-6 md:mb-0">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Support</h3>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">FAQ</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Help Center</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Privacy Policy</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-blue-600 transition-colors duration-300">Terms of Service</a></li>
                </ul>
            </div>

            <div class="w-full md:w-1/4">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Newsletter</h3>
                <p class="text-gray-600 mb-4">Subscribe to our newsletter for the latest updates.</p>
                <form class="flex">
                    <input type="email" placeholder="Your email" class="px-4 py-2 w-full rounded-l-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-r-lg hover:bg-blue-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
            </div>
        </div>

        <div class="border-t border-gray-200 mt-8 pt-6 text-center text-gray-500 text-sm">
            <p>&copy; 2023 AppointScheduler. All rights reserved.</p>
        </div>
    </div>
</footer>

<script>
    function serviceManager() {
        return {
            // Data
            businessData: {
                id: '',
                name: '',
                description: '',
                created_at: ''
            },
            services: [],
            categories: [],
            filteredServices: [],
            selectedCategory: 'all',
            searchQuery: '',

            // UI States
            loading: true,
            error: false,
            errorMessage: '',
            showAddServiceModal: false,
            showDeleteModal: false,

            // Form Data
            serviceForm: {
                id: null,
                name: '',
                description: '',
                price: '',
                duration: 30,
                category_id: ''
            },
            editingService: false,
            serviceToDeleteId: null,

            // Initialization
            init() {
                this.fetchBusinessData();
                this.fetchCategories();
                this.fetchServices();
            },

            // API Calls
            async fetchBusinessData() {
                try {
                    // Mocked API call - Replace with actual API endpoint
                    // const response = await fetch('/api/business');
                    // const data = await response.json();

                    // Mocked data for demonstration
                    setTimeout(() => {
                        this.businessData = {
                            id: 'BUS123456',
                            name: 'Wellness Center',
                            description: 'We provide a range of wellness and therapeutic services designed to improve your health and well-being.',
                            created_at: '2023-01-15T00:00:00Z'
                        };
                    }, 500);
                } catch (error) {
                    console.error('Error fetching business data:', error);
                    this.error = true;
                    this.errorMessage = 'Failed to load business information.';
                }
            },

            async fetchCategories() {
                try {
                    // Mocked API call - Replace with actual API endpoint
                    // const response = await fetch('/api/categories');
                    // const data = await response.json();

                    // Mocked data for demonstration
                    setTimeout(() => {
                        this.categories = [
                            { id: 1, name: 'Massage Therapy' },
                            { id: 2, name: 'Physical Therapy' },
                            { id: 3, name: 'Consultation' },
                            { id: 4, name: 'Specialized Treatment' }
                        ];
                    }, 500);
                } catch (error) {
                    console.error('Error fetching categories:', error);
                    this.error = true;
                    this.errorMessage = 'Failed to load service categories.';
                }
            },

            async fetchServices() {
                try {
                    // Mocked API call - Replace with actual API endpoint
                    // const response = await fetch('/api/services');
                    // const data = await response.json();

                    // Mocked data for demonstration
                    setTimeout(() => {
                        this.services = [
                            {
                                id: 1,
                                name: 'Deep Tissue Massage',
                                description: 'Focused massage targeting deeper layers of muscle and connective tissue.',
                                price: 85.00,
                                duration: 60,
                                category_id: 1
                            },
                            {
                                id: 2,
                                name: 'Swedish Massage',
                                description: 'Gentle, relaxing massage focused on overall relaxation and stress relief.',
                                price: 75.00,
                                duration: 60,
                                category_id: 1
                            },
                            {
                                id: 3,
                                name: 'Initial Consultation',
                                description: 'Comprehensive evaluation of your health needs and treatment planning.',
                                price: 120.00,
                                duration: 90,
                                category_id: 3
                            },
                            {
                                id: 4,
                                name: 'Sports Injury Rehabilitation',
                                description: 'Specialized treatment for sports-related injuries and recovery.',
                                price: 95.00,
                                duration: 45,
                                category_id: 2
                            },
                            {
                                id: 5,
                                name: 'Acupuncture Session',
                                description: 'Traditional Chinese medicine treatment for pain management and wellness.',
                                price: 110.00,
                                duration: 60,
                                category_id: 4
                            }
                        ];

                        this.filteredServices = [...this.services];
                        this.loading = false;
                    }, 1000);
                } catch (error) {
                    console.error('Error fetching services:', error);
                    this.error = true;
                    this.errorMessage = 'Failed to load services.';
                    this.loading = false;
                }
            },

            // UI Functions
            filterServices() {
                this.filteredServices = this.services.filter(service => {
                    // Apply category filter
                    const categoryMatch = this.selectedCategory === 'all' || service.category_id == this.selectedCategory;

                    // Apply search filter (if search query exists)
                    const searchMatch = !this.searchQuery ||
                        service.name.toLowerCase().includes(this.searchQuery.toLowerCase()) ||
                        service.description.toLowerCase().includes(this.searchQuery.toLowerCase());

                    return categoryMatch && searchMatch;
                });
            },

            resetFilters() {
                this.selectedCategory = 'all';
                this.searchQuery = '';
                this.filterServices();
            },

            editService(service) {
                this.editingService = true;
                this.serviceForm = { ...service };
                this.showAddServiceModal = true;
            },

            confirmDeleteService(serviceId) {
                this.serviceToDeleteId = serviceId;
                this.showDeleteModal = true;
            },

            // CRUD Operations
            async saveService() {
                try {
                    if (this.editingService) {
                        // Update existing service
                        // Mocked API call - Replace with actual API endpoint
                        // const response = await fetch(`/api/services/${this.serviceForm.id}`, {
                        //     method: 'PUT',
                        //     headers: { 'Content-Type': 'application/json' },
                        //     body: JSON.stringify(this.serviceForm)
                        // });
                        // const updatedService = await response.json();

                        // Mocked update
                        const index = this.services.findIndex(s => s.id === this.serviceForm.id);
                        if (index !== -1) {
                            this.services[index] = { ...this.serviceForm };
                            alert('Service updated successfully!');
                        }
                    } else {
                        // Add new service
                        // Mocked API call - Replace with actual API endpoint
                        // const response = await fetch('/api/services', {
                        //     method: 'POST',
                        //     headers: { 'Content-Type': 'application/json' },
                        //     body: JSON.stringify(this.serviceForm)
                        // });
                        // const newService = await response.json();

                        // Mocked add
                        const newService = {
                            ...this.serviceForm,
                            id: this.services.length + 1 // Generate fake ID
                        };
                        this.services.push(newService);
                        alert('Service added successfully!');
                    }

                    // Reset form and state
                    this.filterServices();
                    this.resetForm();
                    this.showAddServiceModal = false;
                } catch (error) {
                    console.error('Error saving service:', error);
                    alert('Failed to save service. Please try again.');
                }
            },

            async deleteService() {
                try {
                    // Mocked API call - Replace with actual API endpoint
                    // await fetch(`/api/services/${this.serviceToDeleteId}`, {
                    //     method: 'DELETE'
                    // });

                    // Mocked delete
                    this.services = this.services.filter(s => s.id !== this.serviceToDeleteId);
                    this.filterServices();
                    this.showDeleteModal = false;
                    this.serviceToDeleteId = null;
                    alert('Service deleted successfully!');
                } catch (error) {
                    console.error('Error deleting service:', error);
                    alert('Failed to delete service. Please try again.');
                }
            },

            resetForm() {
                this.serviceForm = {
                    id: null,
                    name: '',
                    description: '',
                    price: '',
                    duration: 30,
                    category_id: ''
                };
                this.editingService = false;
            },

            // Helper Functions
            formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return new Intl.DateTimeFormat('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }).format(date);
            },

            formatPrice(price) {
                return new Intl.NumberFormat('en-US', {
                    style: 'currency',
                    currency: 'USD'
                }).format(price);
            },

            getCategoryName(categoryId) {
                const category = this.categories.find(c => c.id == categoryId);
                return category ? category.name : 'Uncategorized';
            }
        };
    }
</script>

</body>
</html>